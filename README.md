# 植物辨識應用程式使用手冊

## 目錄
1. [簡介](#簡介)
2. [系統需求](#系統需求)
3. [安裝指南](#安裝指南)
4. [模型訓練指南](#模型訓練指南)
5. [使用指南](#使用指南)
6. [功能說明](#功能說明)
7. [常見問題](#常見問題)
8. [故障排除](#故障排除)

## 簡介

植物辨識應用程式是一個基於深度學習技術的網頁應用，能夠辨識12種不同的植物。本應用程式使用 Python Flask 作為後端框架，TensorFlow 作為深度學習框架，並提供了友好的使用者介面，支援透過網頁端訪問 webcam 或手機相機來截取要辨識的圖像。

主要功能包括：
- 透過上傳照片或使用相機拍攝來辨識植物
- 顯示辨識結果詳情和植物資訊
- 保存辨識歷史記錄
- 提供植物資訊庫

## 系統需求

### 硬體需求
- 處理器：建議 Apple M 系列晶片（如您的 Mac mini M4）或同等效能的處理器
- 記憶體：至少 8GB RAM（建議 16GB 或以上，您的 24GB 配置非常適合）
- 儲存空間：至少 2GB 可用空間（用於應用程式、依賴項和模型）

### 軟體需求
- 作業系統：macOS Sonoma 或更新版本
- Python 3.9 或更高版本
- 網頁瀏覽器：Safari、Chrome、Firefox 或 Edge 的最新版本

## 安裝指南

### 1. 安裝 Python

如果您的 Mac 尚未安裝 Python，請從 [Python 官網](https://www.python.org/downloads/) 下載並安裝最新版本的 Python。

您也可以使用 Homebrew 安裝 Python：

```bash
brew install python
```

### 2. 下載應用程式

將應用程式檔案下載到您的電腦，或使用 Git 克隆儲存庫：

```bash
git clone <儲存庫網址> plant_recognition
cd plant_recognition
```

### 3. 設置虛擬環境

在終端機中執行以下命令來創建並啟用虛擬環境：

```bash
python3 -m venv venv
source venv/bin/activate
```

### 4. 安裝依賴項

啟用虛擬環境後，安裝所需的依賴項：

```bash
pip install -r requirements.txt
```

如果沒有 requirements.txt 文件，可以手動安裝以下依賴項：

```bash
pip install flask tensorflow pillow opencv-python matplotlib scikit-learn
```

### 5. 準備模型

如果您已經有訓練好的模型，請將其放入 `models` 目錄並命名為 `plant_model.h5`。

如果您需要訓練自己的模型，請參考[模型訓練指南](#模型訓練指南)部分。

### 6. 運行應用程式

使用提供的啟動腳本運行應用程式：

```bash
chmod +x run_app.sh
./run_app.sh
```

或者直接使用 Python 運行：

```bash
source venv/bin/activate
python app.py
```

應用程式將在 http://localhost:5000 運行，您可以使用瀏覽器訪問此地址。

## 模型訓練指南

### 準備資料集

1. 創建資料目錄結構：

```bash
mkdir -p data/plants
```

2. 將您的12種植物照片放入對應的子目錄中，每個植物一個子目錄，使用植物的中文名稱作為目錄名：

```
data/plants/
  ├── 植物1/
  │   ├── image1.jpg
  │   ├── image2.jpg
  │   └── ...
  ├── 植物2/
  │   ├── image1.jpg
  │   ├── image2.jpg
  │   └── ...
  └── ...
```

3. 確保每個植物類別至少有 30-50 張不同角度、不同光線條件下的照片，以提高模型的準確性。

### 訓練模型

1. 確保您已經安裝了所有必要的依賴項。

2. 運行訓練腳本：

```bash
python train_model.py
```

3. 訓練過程將顯示進度和準確率信息。根據您的電腦性能和資料集大小，訓練可能需要幾分鐘到幾小時不等。

4. 訓練完成後，模型將保存在 `models` 目錄中，命名為 `plant_model.h5`。

### 自定義訓練參數

如果您需要調整訓練參數，可以編輯 `train_model.py` 文件中的以下參數：

- `EPOCHS`：訓練輪數，預設為 20
- `BATCH_SIZE`：批次大小，預設為 32
- `IMG_SIZE`：圖像大小，預設為 (224, 224)

例如，要增加訓練輪數到 50，可以修改：

```python
EPOCHS = 50
```

### 使用預訓練模型

如果您不想從頭開始訓練模型，可以使用我們提供的預訓練模型：

1. 下載預訓練模型文件 `plant_model.h5`
2. 將其放入 `models` 目錄中

## 使用指南

### 啟動應用程式

1. 開啟終端機，進入應用程式目錄
2. 執行啟動腳本：`./run_app.sh`
3. 在瀏覽器中訪問 http://localhost:5000

### 上傳照片辨識

1. 在首頁點擊「選擇照片」按鈕
2. 從您的設備中選擇一張植物照片
3. 點擊「上傳並辨識」按鈕
4. 等待系統處理並顯示辨識結果

### 使用相機辨識

1. 在首頁點擊「開啟相機」按鈕
2. 允許瀏覽器使用您的相機
3. 將相機對準植物
4. 點擊拍攝按鈕
5. 在預覽頁面確認照片，點擊「辨識植物」按鈕
6. 等待系統處理並顯示辨識結果

### 查看歷史記錄

1. 點擊頂部導航欄的「歷史記錄」
2. 瀏覽您之前的辨識結果

### 查看植物資訊

1. 點擊頂部導航欄的「植物資訊」
2. 瀏覽所有支援辨識的植物詳細資訊
3. 使用搜尋框快速找到特定植物

## 功能說明

### 首頁

首頁提供兩種辨識植物的方式：上傳照片或使用相機拍攝。同時顯示系統支援的植物種類列表。

### 相機頁面

相機頁面允許您使用設備的相機拍攝植物照片。在移動設備上，您可以切換前置和後置相機。

### 辨識結果頁面

辨識成功後，結果頁面會顯示：
- 辨識出的植物名稱
- 辨識置信度
- 植物詳細資訊和照顧提示
- 分享結果的選項

### 無法辨識頁面

當系統無法辨識植物時，會顯示可能的原因和建議，幫助您獲得更好的辨識結果。

### 歷史記錄頁面

歷史記錄頁面保存您之前的所有辨識結果，包括照片、辨識結果和時間戳記。

### 植物資訊頁面

植物資訊頁面提供所有支援辨識的植物的詳細資訊，包括描述和照顧提示。

## 常見問題

### 相機無法開啟

**問題**：點擊「開啟相機」後，相機沒有啟動。

**解決方案**：
- 確保您已授予瀏覽器使用相機的權限
- 確保沒有其他應用程式正在使用相機
- 嘗試重新整理頁面或使用不同的瀏覽器

### 辨識結果不準確

**問題**：系統辨識結果與實際植物不符。

**解決方案**：
- 確保照片清晰且光線充足
- 嘗試從不同角度拍攝植物
- 確保植物在照片中佔據主要部分
- 考慮重新訓練模型，增加更多該植物的樣本

### 模型訓練失敗

**問題**：運行 `train_model.py` 時出現錯誤。

**解決方案**：
- 確保已安裝所有必要的依賴項
- 確保資料集結構正確
- 檢查是否有足夠的磁碟空間和記憶體
- 嘗試減小批次大小 (BATCH_SIZE)

## 故障排除

### 應用程式無法啟動

**問題**：運行 `run_app.sh` 時出現錯誤。

**解決方案**：
- 確保已激活虛擬環境：`source venv/bin/activate`
- 確保已安裝所有依賴項：`pip install -r requirements.txt`
- 檢查錯誤訊息，可能需要安裝特定的系統依賴項

### 瀏覽器顯示「無法連接到伺服器」

**問題**：瀏覽器無法訪問 http://localhost:5000。

**解決方案**：
- 確保應用程式正在運行
- 檢查終端機是否有錯誤訊息
- 確保沒有防火牆阻止連接
- 嘗試使用不同的端口：修改 `app.py` 中的 `app.run(host='0.0.0.0', port=5000, debug=True)` 為其他端口

### 上傳大文件失敗

**問題**：上傳大型圖像文件時失敗。

**解決方案**：
- 嘗試壓縮圖像或使用較小的圖像
- 修改 Flask 配置以支援更大的文件上傳：
  ```python
  app.config['MAX_CONTENT_LENGTH'] = 16 * 1024 * 1024  # 16MB
  ```

---

如有任何其他問題或建議，請聯繫開發者。
